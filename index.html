<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Imagery CSS -->
    <link href="assets/css/main.css" rel="stylesheet">
    
    <!--JQuery javascript-->
    <script src="assets/js/jquery.min.js"></script>
    <!--Slick javascript-->
    <script src="assets/slick/slick.min.js"></script>

    <title>Imagery</title>
  </head>
  <body>
    <div class="page-loader">Loading</div>
    <nav class="navbar">
        <ul class="nav">
            <li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
            <li class="nav-item"><a href="plans.html" class="nav-link">Plans</a></li>
        </ul>
    </nav>

    <div class="slider">
      <img src="assets/images/sunset-in-the-mountains.png">
      <img src="assets/images/sunset-in-the-mountains.png">
      <img src="assets/images/sunset-in-the-mountains.png">
      <img src="assets/images/sunset-in-the-mountains.png">
      <img src="assets/images/sunset-in-the-mountains.png">
    </div>

    <div class="container">

      <center><h1>Featured Plans</h1></center>
      
      <div class="row" id="all-plans">
        
        <div class="col"> 
          <div class="card">
            <img src="assets/images/sunset-in-the-mountains.png">
            <div class="body">
              <p>This is some card content in the card body This is some card content in the card body</p>
              <div class="btn-group">
                <a href="plan.html" class="btn">View Plan</a>
              </div>
            </div>
          </div>
        </div>

        <div class="col">
          <div class="card">
            <img src="assets/images/sunset-in-the-mountains.png">
            <div class="body">
              <p>This is some card content in the card body This is some card content in the card body</p>
              <div class="btn-group">
                <a href="plan.html" class="btn">View Plan</a>
              </div>
            </div>
          </div>
        </div>

        <div class="col">
          <div class="card">
            <img src="assets/images/sunset-in-the-mountains.png">
            <div class="body">
              <p>This is some card content in the card body This is some card content in the card body</p>
              <div class="btn-group">
                <a href="plan.html" class="btn">View Plan</a>
              </div>
            </div>
          </div>
        </div>

      </div>
      <br>
      <center><a href="plans.html" class="btn" style="width:100%;">View more</a></center>

      <div class="modal" id="modal">
        <div class="dialog">
          <div class="header"><button class="btn close" data-target="#modal">Close</button></div>
          <div class="body">

            <div class="card">
              <img src="assets/images/sunset-in-the-mountains.png">
              <div class="body">
                <p>House Plan description goes here</p>

                <ul class="list">
                  <li class="item">house plan attributes</li>
                  <li class="item">house plan attributes</li>
                  <li class="item">house plan attributes</li>
                  <li class="item">house plan attributes</li>
                </ul>

                <div class="row">
                  <div class="col">
                    <div class="btn-group">
                      <button class="btn">Buy Plan</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>

    </div>
    <script>
    function render_slides(slides){
      var slider = document.querySelector(".slider");
      //$(slider).slick("unslick");
      $(slider).html("");
      for(var i=0;i<slides.length;i++){
        var img = new Image();
        img.src = slides[i].picture;
        slider.append(img);
      }
      $(".slider").slick({
          infinity: true,
          dots: true,
          slidesToShow: 3,
          slidesToScroll: 1,
          autoplay: true,
          speed: 500,
          responsive: [
              {
                  breakpoint: 600,
                  settings: {
                      slidesToShow: 1,
                      slidesToScroll: 1
                  }
              }
          ]
      });
      $(".slick-prev").html("<");
      $(".slick-next").html(">");
    }
    function get_slides(){
      $.get("/api/plan.php?type=all_slide", (data)=>{
        render_slides(data);
      });
    }
    get_slides();
    
    var plans;
    function render_plans(allplans){
      try {
        var el = document.querySelector("#all-plans");
        el.innerHTML = "";
        for(var i=0;i<allplans.length;i++){
          var col = document.createElement("div");
          col.classList.add("col");
          var card = document.createElement("div");
          card.classList.add("card");
          var img = new Image();
          img.src = allplans[i].picture;
          card.append(img);
          var body = document.createElement("div");
          body.classList.add("body");
          var p = document.createElement("p");
          p.innerHTML = allplans[i].description;
          body.append(p);
          var btn_group = document.createElement("div");
          btn_group.classList.add("btn-group");
          var btn = document.createElement("a");
          btn.classList.add("btn");
          btn.setAttribute("href", "plan.html?id="+allplans[i].id);
          btn.innerHTML = "K"+allplans[i].price+" - View";
          btn_group.append(btn);
          body.append(btn_group);
          card.append(body);
          col.append(card);
          el.append(col);
        }
      } catch(error){
        alert(error.message);
      }
    }
    function get_plans(){
      $.get("/api/plan.php?type=all", (data, status)=>{
        plans = data;
        render_plans(plans.slice(0,10));
      });
    }
    $(document).ready(()=>{
      get_plans();
      $(".page-loader").hide();
    });
    </script>

    <footer>
      <div class="container">
        <form action="plan-files.html" method="get">
            <div class="input-group">
                <label>Access Code</label>
                <input type="text" class="form-control" name="access_code" placeholder="Enter access code" required>
            </div>
            <input type="submit" class="btn form-control" value="Submit"> 
        </form>
      </div>
      <h2 class="footer-heading">Social Links</h2>
      <a href="#" class="btn">Facebook</a>
      <a href="#" class="btn">Tweeter</a>
      <a href="#" class="btn">YouTube</a>
      <div class="bar">
        &copy; Imagery 2021, proudly designed by <a href="https://linkedin.com/in/fshangala">fshangala</a>
      </div>
    </footer>

    <!--Imagery javascript-->
    <script src="assets/js/main.js"></script>
  </body>
</html>